pipeline {
  agent {
    docker {
      image 'node:8.11.4'
      args '-u 0:0'
    }
  }

  stages {

    // stage ('Prepare') {
    //   steps {
    //     sh 'node --version; npm --version'
    //     sh 'npm install'
    //     sh 'ls -la ./node_modules'
    //     sh './node_modules/.bin/bower install --allow-root'
    //   }
    // }

    // stage ('Test') {
    //   steps {
    //     script {
    //       sh './node_modules/.bin/eslint --ext .js src/'
    //     }
    //   }
    // }

    stage ('Build') {
      steps {
        script {
          // sh 'tar -zcvf app.tar.gz src'
          sshagent(['test-identity']) {
            // sh 'echo SSH_AUTH_SOCK=$SSH_AUTH_SOCK'
            // sh 'ls -al $SSH_AUTH_SOCK || true'
            // sh 'ssh -vvv -o StrictHostKeyChecking=no ubuntu@example.org uname -a'
            // sh 'scp app.tar.gz root@104.248.51.10:/root'
            sh 'ssh -o StrictHostKeyChecking=no root@104.248.51.10 "ls -la"'
            // sh 'ssh -o StrictHostKeyChecking=no -y root@104.248.51.10 "sh build.sh"'
          }
        }
      }
    }
  }
}